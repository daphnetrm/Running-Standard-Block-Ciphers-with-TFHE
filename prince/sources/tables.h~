#ifndef H_TABLES
#define H_TABLES

#include <stdio.h>
#include <tfhe/tfhe.h>
#include <tfhe/tfhe_io.h>

#include "base_b_keyswitchkey.h"
#include "base_b_keyswitch.h"

typedef unsigned char word8;
typedef unsigned int word32;
using std::vector;





extern uint64_t RC[12];
extern word8 sbox[16];
extern word8 sbox_inv[16];
extern word8 and_8[16];
extern word8 and_4[16];
extern word8 and_2[16];
extern word8 and_1[16];
extern word8 id[16];


void XOR_fhe(vector <LweSample*> &v1, vector <LweSample*> &v2, TFheGateBootstrappingSecretKeySet* gk, BaseBKeySwitchKey* ks_key);

void and_fhe (vector <LweSample*> &result, vector <LweSample*> &b, TFheGateBootstrappingSecretKeySet* gk, BaseBKeySwitchKey* ks_key, word8 tab[16]);

void testv_and(TorusPolynomial *testv, int32_t N, word8 tab[16]);

void tLweMulByXai(TLweSample *result, int32_t ai, const TLweSample *bk, const TLweParams *params);
void ks_batching(int i, uint8_t B, vector <LweSample*> &resLwe, vector<TLweSample*> &resTLwe, const TLweKey * k_out, BaseBKeySwitchKey* ks_key);

void print_tables_Tx_b16();
void testv_b16(TorusPolynomial *testv, int32_t N, uint8_t idx, word8 tab[256]);
void testv_vi_b16(IntPolynomial *testv, int32_t N, uint8_t idx, word8 tab[256]);
void test_v0(TorusPolynomial *testv, int32_t N);

void print_tables_XOR();

void Enc_tab (vector <LweSample*> tab_fhe[8], word8 tab[8], TFheGateBootstrappingSecretKeySet* key);
void encode(word8 retour[8], uint64_t m);
   
#endif
