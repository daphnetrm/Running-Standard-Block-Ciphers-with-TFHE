#ifndef __SIMON_H__
#define __SIMON_REF_H__

#include <random>
#include <string.h>
#include <stdio.h>
#include <stdint.h>
#include <tfhe/tfhe.h>
#include <tfhe/tfhe_io.h>
#include <math.h>
#include <vector>
#include <iostream>
#include <cassert>
#include <unistd.h>
#include <time.h>
#include <tfhe/tfhe_garbage_collector.h>
#include "base_b_keyswitchkey.h"
#include "base_b_keyswitch.h"

using namespace std;
#define u64 uint64_t

#define ROTL64(x,r) (((x)<<(r)) | (x>>(64-(r))))
#define ROTR64(x,r) (((x)>>(r)) | ((x)<<(64-(r))))

void SimonKeySchedule(u64 K[],u64 rk[]);
void SimonEncrypt(u64 Pt[],u64 Ct[],u64 rk[]);
void SimonDecrypt(u64 Pt[],u64 Ct[],u64 rk[]);

void encrypt_fhe(vector<LweSample*> x[8], vector<LweSample*> y[8], vector<LweSample*> rcki[68][8], TFheGateBootstrappingSecretKeySet* gk, BaseBKeySwitchKey* ks_key);


#endif //__SIMON_H__
